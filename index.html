<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ëª¨ì˜ì£¼ì‹íˆ¬ìê²Œì„ MVP</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--text:#e5e7eb;--muted:#94a3b8;--pos:#16a34a;--neg:#ef4444;--accent:#3b82f6}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, sans-serif}
    a{color:var(--accent)}
    header,footer,nav,main{max-width:1200px;margin:auto;padding:12px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{font-weight:700}
    .top-controls{display:flex;gap:8px;align-items:center}
    .btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:10px;cursor:pointer}
    .btn.secondary{background:#334155}
    .grid{display:grid;gap:12px}
    .grid.cols-2{grid-template-columns:repeat(2,1fr)}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:12px}
    .kpi{display:flex;align-items:center;justify-content:space-between}
    .kpi small{color:var(--muted)}
    .pos{color:var(--pos)} .neg{color:var(--neg)}
    .tabs{display:flex;gap:6px;flex-wrap:wrap;margin:10px 0}
    .tab{padding:8px 12px;border-radius:10px;border:1px solid #334155;background:#0b1220;color:#cbd5e1;cursor:pointer}
    .tab[aria-selected="true"]{background:#1e293b;border-color:#3b82f6;color:#fff}
    .list{display:flex;flex-direction:column;gap:8px}
    .row{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:10px;background:#0b1220;border:1px solid #1f2937}
    .row .muted{color:var(--muted)}
    .split{display:grid;grid-template-columns:2fr 1fr;gap:12px}
    @media (max-width: 900px){.grid.cols-3{grid-template-columns:1fr}.grid.cols-2{grid-template-columns:1fr}.split{grid-template-columns:1fr}}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    input,select{background:#0b1220;color:#e5e7eb;border:1px solid #334155;border-radius:10px;padding:8px}
    label{display:block;margin:6px 0 4px;color:#cbd5e1}
    .toast{position:fixed;right:12px;bottom:12px;background:#1f2937;color:#fff;padding:10px 12px;border-radius:10px;border:1px solid #334155;display:none}
    .badge{font-size:12px;padding:2px 8px;border-radius:999px;background:#0b1220;border:1px solid #334155;color:#cbd5e1}
    .footer-note{color:#94a3b8;font-size:13px}
  </style>
</head>
<body>
  <a class="sr-only" href="#main">ë³¸ë¬¸ ë°”ë¡œê°€ê¸°</a>
  <header role="banner">
    <div class="brand" aria-label="ì‚¬ì´íŠ¸ ë¡œê³ ">ğŸ“ˆ ëª¨ì˜ì£¼ì‹íˆ¬ìê²Œì„</div>
    <div class="top-controls" role="group" aria-label="ìƒë‹¨ ë„êµ¬">
      <label for="date" class="sr-only">ë‚ ì§œ ì„ íƒ</label>
      <input id="date" type="date" aria-label="ë‚ ì§œ ì„ íƒ" />
      <button class="btn secondary" id="a11yToggle" aria-pressed="false">Aa/ê³ ëŒ€ë¹„</button>
      <button class="btn" id="ttsBtn" aria-label="í˜„ì¬ ìš”ì•½ ì½ê¸°">TTS</button>
      <button class="btn secondary" id="notifBtn">ì•Œë¦¼ í—ˆìš©</button>
      <button class="btn" id="tutorialBtn">íŠœí† ë¦¬ì–¼</button>
    </div>
  </header>

  <nav aria-label="ì£¼ìš” ì„¹ì…˜" style="max-width:1200px;margin:auto;padding:0 12px 12px;">
    <div class="tabs" role="tablist">
      <button role="tab" class="tab" aria-selected="true" aria-controls="tab-home" id="tab-home-btn">í™ˆ</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="tab-market" id="tab-market-btn">ì‹œì¥</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="tab-trade" id="tab-trade-btn">ê±°ë˜</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="tab-portfolio" id="tab-portfolio-btn">í¬íŠ¸í´ë¦¬ì˜¤</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="tab-league" id="tab-league-btn">ë¦¬ê·¸</button>
    </div>
  </nav>

  <main id="main" tabindex="-1">
    <!-- í™ˆ -->
    <section id="tab-home" role="tabpanel" aria-labelledby="tab-home-btn">
      <div class="grid cols-3">
        <div class="card kpi" aria-live="polite">
          <div>
            <div>ì˜¤ëŠ˜ì˜ ìš”ì•½</div>
            <small class="muted" id="summaryText">KOSPI â–²0.8%, í…Œë§ˆ: 2ì°¨ì „ì§€, í™˜ìœ¨ ë³´í•©</small>
          </div>
          <span class="badge" id="todayBadge">ì˜¤ëŠ˜</span>
        </div>
        <div class="card">
          <div class="kpi"><strong>KOSPI</strong><span id="k-kospi" class="pos">â–² 0.8%</span></div>
          <small class="muted">ì „ì¼ ëŒ€ë¹„</small>
        </div>
        <div class="card">
          <div class="kpi"><strong>KOSDAQ</strong><span id="k-kosdaq" class="neg">â–¼ 0.5%</span></div>
          <small class="muted">ì „ì¼ ëŒ€ë¹„</small>
        </div>
      </div>

      <div class="grid cols-2" style="margin-top:12px">
        <div class="card">
          <h2 style="margin:0 0 8px">ì§„í–‰ ì¤‘ ë¦¬ê·¸</h2>
          <div class="list" id="leagueList" aria-live="polite"></div>
        </div>
        <div class="card">
          <h2 style="margin:0 0 8px">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</h2>
          <div class="list" id="missionList"></div>
        </div>
      </div>
    </section>

    <!-- ì‹œì¥ -->
    <section id="tab-market" role="tabpanel" aria-labelledby="tab-market-btn" hidden>
      <div class="tabs" role="tablist" aria-label="ì‹œì¥ í•˜ìœ„ íƒ­">
        <button class="tab" aria-selected="true" aria-controls="mkt-index" id="tab-mkt-index">ì§€ìˆ˜</button>
        <button class="tab" aria-selected="false" aria-controls="mkt-search" id="tab-mkt-search">ì¢…ëª©ê²€ìƒ‰</button>
        <button class="tab" aria-selected="false" aria-controls="mkt-news" id="tab-mkt-news">ë‰´ìŠ¤</button>
      </div>
      <div id="mkt-index" role="tabpanel" aria-labelledby="tab-mkt-index">
        <div class="grid cols-3" id="indexGrid"></div>
      </div>
      <div id="mkt-search" role="tabpanel" aria-labelledby="tab-mkt-search" hidden>
        <label for="search">ì¢…ëª©/ì‹¬ë³¼ ê²€ìƒ‰</label>
        <input id="search" placeholder="ì˜ˆ: ì‚¼ì„±ì „ì, 005930" />
        <div class="list" id="searchResults" style="margin-top:8px"></div>
      </div>
      <div id="mkt-news" role="tabpanel" aria-labelledby="tab-mkt-news" hidden>
        <div class="list" id="newsList"></div>
      </div>
    </section>

    <!-- ê±°ë˜ -->
    <section id="tab-trade" role="tabpanel" aria-labelledby="tab-trade-btn" hidden>
      <div class="split">
        <div class="card" id="symbolPanel">
          <h2 style="margin:0 0 6px" id="symbolTitle">ì‚¼ì„±ì „ì (005930)</h2>
          <div class="muted" id="symbolPrice">í˜„ì¬ê°€ 72,300 (+1.2%)</div>
          <div style="margin-top:10px" class="muted">ì°¨íŠ¸(ìƒ˜í”Œ) Â· ë‰´ìŠ¤ 3ê±´ Â· ì¬ë¬´ ìŠ¤ëƒ…ìƒ·</div>
        </div>
        <div class="card" aria-label="ì£¼ë¬¸ íŒ¨ë„">
          <h2 style="margin:0 0 8px">ì£¼ë¬¸</h2>
          <label for="orderType">ì£¼ë¬¸ìœ í˜•</label>
          <select id="orderType" aria-label="ì£¼ë¬¸ìœ í˜•">
            <option value="market">ì‹œì¥ê°€</option>
            <option value="limit">ì§€ì •ê°€</option>
          </select>
          <label for="qty">ìˆ˜ëŸ‰</label>
          <input id="qty" type="number" min="1" value="10" />
          <label for="limitPx" id="limitLabel" hidden>ì§€ì •ê°€</label>
          <input id="limitPx" type="number" step="10" hidden />
          <div style="margin:8px 0" id="orderPreview" class="muted">ì˜ˆìƒê¸ˆì•¡: â‚©723,000 Â· ìˆ˜ìˆ˜ë£Œ ì•½ â‚©2,169</div>
          <div style="display:flex; gap:8px">
            <button class="btn" id="buyBtn">ë§¤ìˆ˜(B)</button>
            <button class="btn secondary" id="sellBtn">ë§¤ë„(S)</button>
          </div>
          <small class="muted">ë¦¬ìŠ¤í¬ ê°€ë“œ: ì£¼ë¬¸ í•œë„ 2,000,000 / ì¼ì†ì‹¤ í•œë„ -10%</small>
        </div>
      </div>
    </section>

    <!-- í¬íŠ¸í´ë¦¬ì˜¤ -->
    <section id="tab-portfolio" role="tabpanel" aria-labelledby="tab-portfolio-btn" hidden>
      <div class="card">
        <h2 style="margin:0 0 8px">ìì‚° ìš”ì•½</h2>
        <div class="grid cols-3">
          <div class="kpi"><span>í‰ê°€ê¸ˆì•¡</span><strong id="pfValue">â‚©1,024,300</strong></div>
          <div class="kpi"><span>ëˆ„ì ì†ìµ</span><strong id="pfPnL" class="pos">+2.4%</strong></div>
          <div class="kpi"><span>í˜„ê¸ˆ</span><strong id="pfCash">â‚©200,000</strong></div>
        </div>
      </div>
      <div class="card" style="margin-top:12px">
        <h2 style="margin:0 0 8px">ë³´ìœ  ìì‚°</h2>
        <div role="table" aria-label="ë³´ìœ  ìì‚° í‘œ">
          <div role="row" class="row" aria-rowindex="1">
            <div role="columnheader" style="width:30%">ì¢…ëª©</div>
            <div role="columnheader" style="width:15%">ìˆ˜ëŸ‰</div>
            <div role="columnheader" style="width:20%">í‰ê°€ê¸ˆì•¡</div>
            <div role="columnheader" style="width:15%">ì†ìµ%</div>
            <div role="columnheader" style="width:20%">ë¹„ì¤‘</div>
          </div>
          <div id="pfTable" aria-live="polite"></div>
        </div>
      </div>
    </section>

    <!-- ë¦¬ê·¸ -->
    <section id="tab-league" role="tabpanel" aria-labelledby="tab-league-btn" hidden>
      <div class="grid cols-2">
        <div class="card">
          <h2 style="margin:0 0 8px">ë¦¬ê·¸ ëª©ë¡</h2>
          <div class="list" id="leagueAll"></div>
        </div>
        <div class="card">
          <h2 style="margin:0 0 8px">ë­í‚¹(Top 10)</h2>
          <div class="list" id="rankList"></div>
        </div>
      </div>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="footer-note">êµìœ¡ ëª©ì ì˜ ëª¨ì˜íˆ¬ì ì„œë¹„ìŠ¤ Â· ë°ì´í„°ëŠ” ì˜ˆì‹œì´ë©° ì‹¤ì œ íˆ¬ìì— ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.</div>
  </footer>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // --- ë”ë¯¸ ë°ì´í„° ---
    const leagues = [
      { title: '3Aë°˜ ë¦¬ê·¸', period: '09/01â€“09/30', myRank: 5 },
      { title: 'ê²½ì œë™ì•„ë¦¬ S1', period: '09/10â€“10/10', myRank: 12 }
    ];
    const missions = [
      { title: 'ì„¹í„° 4ê°œ ì´ìƒ ë¶„ì‚° ë‹¬ì„±', reward: 'ë°°ì§€ +10XP' },
      { title: 'ì†ì ˆê°€ ì„¤ì •í•˜ê¸°', reward: '+5XP' }
    ];
    const indices = [
      { name: 'KOSPI', chg: +0.82 },
      { name: 'KOSDAQ', chg: -0.47 },
      { name: 'S&P500', chg: +0.15 }
    ];
    const holdings = [
      { sym: '005930', name: 'ì‚¼ì„±ì „ì', qty: 10, value: 723000, pnl: +1.2, weight: 35 },
      { sym: '000660', name: 'SKí•˜ì´ë‹‰ìŠ¤', qty: 3, value: 411000, pnl: -0.8, weight: 20 },
      { sym: '069500', name: 'KODEX200', qty: 5, value: 388000, pnl: +0.5, weight: 18 }
    ];

    // --- ìœ í‹¸ ---
    const fmt = n => n.toLocaleString('ko-KR');
    function toast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg; t.style.display='block';
      setTimeout(()=>{t.style.display='none'}, 2000);
    }

    // --- ì´ˆê¸° ë Œë” ---
    function renderHome(){
      const ll = document.getElementById('leagueList');
      ll.innerHTML = leagues.map(l=>`<div class="row"><div><strong>${l.title}</strong><div class="muted">${l.period}</div></div><div>ë‚´ ìˆœìœ„ <strong>${l.myRank}</strong></div></div>`).join('');
      const ml = document.getElementById('missionList');
      ml.innerHTML = missions.map(m=>`<div class="row"><div><strong>${m.title}</strong><div class="muted">ë³´ìƒ: ${m.reward}</div></div><button class="btn secondary" onclick="toast('ë¯¸ì…˜ ì‹œì‘: ${m.title}')">ì‹œì‘</button></div>`).join('');
    }
    function renderMarket(){
      const grid = document.getElementById('indexGrid');
      grid.innerHTML = indices.map(ix=>`<div class="card kpi"><span>${ix.name}</span><strong class="${ix.chg>=0?'pos':'neg'}">${ix.chg>=0?'â–²':'â–¼'} ${Math.abs(ix.chg).toFixed(2)}%</strong></div>`).join('');
      const news = [
        { title:'ë©”ëª¨ë¦¬ ì—…í™© ê°œì„  ê¸°ëŒ€', source:'ë¨¸ë‹ˆíˆ¬ë°ì´', time:'10ë¶„ ì „' },
        { title:'ì›/ë‹¬ëŸ¬ í™˜ìœ¨ ë³´í•©ê¶Œ', source:'ì—°í•©ì¸í¬ë§¥ìŠ¤', time:'20ë¶„ ì „' }
      ];
      document.getElementById('newsList').innerHTML = news.map(n=>`<div class="row"><div><strong>${n.title}</strong><div class="muted">${n.source} Â· ${n.time}</div></div><button class="btn secondary" onclick="toast('ì €ì¥ë¨')">ì €ì¥</button></div>`).join('');
    }
    function renderPortfolio(){
      const el = document.getElementById('pfTable');
      el.innerHTML = holdings.map((h,i)=>`
        <div role="row" class="row" aria-rowindex="${i+2}">
          <div role="cell" style="width:30%">${h.name}<div class="muted">${h.sym}</div></div>
          <div role="cell" style="width:15%">${fmt(h.qty)}</div>
          <div role="cell" style="width:20%">â‚©${fmt(h.value)}</div>
          <div role="cell" style="width:15%" class="${h.pnl>=0?'pos':'neg'}">${h.pnl>=0?'+':''}${h.pnl}%</div>
          <div role="cell" style="width:20%">${h.weight}%</div>
        </div>`).join('');
    }
    function renderLeague(){
      document.getElementById('leagueAll').innerHTML = leagues.map(l=>`<div class="row"><div><strong>${l.title}</strong><div class="muted">${l.period}</div></div><button class="btn" onclick="toast('ì°¸ê°€ ì½”ë“œ ì „ì†¡')">ì°¸ê°€</button></div>`).join('');
      document.getElementById('rankList').innerHTML = Array.from({length:10}, (_,i)=>`<div class="row"><div>#${i+1}</div><div>ì‚¬ìš©ì${i+1}</div><div class="pos">+${(Math.random()*10).toFixed(1)}%</div></div>`).join('');
    }

    renderHome(); renderMarket(); renderPortfolio(); renderLeague();

    // --- íƒ­ ì „í™˜ ---
    const tabs = ['home','market','trade','portfolio','league'];
    tabs.forEach(name=>{
      document.getElementById(`tab-${name}-btn`).addEventListener('click', ()=>{
        tabs.forEach(n=>{
          const btn = document.getElementById(`tab-${n}-btn`);
          const panel = document.getElementById(`tab-${n}`);
          const active = n===name;
          btn.setAttribute('aria-selected', active);
          panel.hidden = !active;
        });
        document.getElementById(`tab-${name}`).focus();
      });
    });

    // --- ì£¼ë¬¸ íŒ¨ë„ ---
    const orderType = document.getElementById('orderType');
    const limitPx = document.getElementById('limitPx');
    const limitLabel = document.getElementById('limitLabel');
    orderType.addEventListener('change', ()=>{
      const isLimit = orderType.value==='limit';
      limitPx.hidden = !isLimit; limitLabel.hidden = !isLimit;
    });
    document.getElementById('buyBtn').addEventListener('click', ()=> toast('ë§¤ìˆ˜ ì£¼ë¬¸ì´ ì „ì†¡ë˜ì—ˆì–´ìš” (ìƒ˜í”Œ)'));
    document.getElementById('sellBtn').addEventListener('click', ()=> toast('ë§¤ë„ ì£¼ë¬¸ì´ ì „ì†¡ë˜ì—ˆì–´ìš” (ìƒ˜í”Œ)'));

    // --- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ---
    document.addEventListener('keydown', (e)=>{
      if(e.key.toLowerCase()==='b') document.getElementById('buyBtn').click();
      if(e.key.toLowerCase()==='s') document.getElementById('sellBtn').click();
      if(e.key.toLowerCase()==='p') document.getElementById('tab-portfolio-btn').click();
      if(e.key.toLowerCase()==='l') document.getElementById('tab-league-btn').click();
    });

    // --- ì ‘ê·¼ì„± í† ê¸€(ê³ ëŒ€ë¹„ ë°ëª¨) ---
    const a11yBtn = document.getElementById('a11yToggle');
    a11yBtn.addEventListener('click', ()=>{
      const pressed = a11yBtn.getAttribute('aria-pressed')==='true';
      a11yBtn.setAttribute('aria-pressed', String(!pressed));
      document.documentElement.style.setProperty('--bg', pressed?'#0f172a':'#000');
      document.documentElement.style.setProperty('--card', pressed?'#111827':'#000');
      document.documentElement.style.setProperty('--text', pressed?'#e5e7eb':'#fff');
      document.documentElement.style.setProperty('--muted', pressed?'#94a3b8':'#cbd5e1');
    });

    // --- TTS(ë¸Œë¼ìš°ì € ìŠ¤í”¼ì¹˜ í•©ì„±) ---
    document.getElementById('ttsBtn').addEventListener('click', ()=>{
      const text = 'ì˜¤ëŠ˜ì˜ ìš”ì•½. ì½”ìŠ¤í”¼ í”ŒëŸ¬ìŠ¤ 0.8 í¼ì„¼íŠ¸, ì£¼ìš” í…Œë§ˆ 2ì°¨ ì „ì§€, í™˜ìœ¨ ë³´í•©ì…ë‹ˆë‹¤.';
      if('speechSynthesis' in window){
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ko-KR';
        window.speechSynthesis.cancel();
        window.speechSynthesis.speak(u);
      } else {
        toast('ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•Šì•„ìš”');
      }
    });

    // --- í•˜ìœ„ íƒ­ ì „í™˜ ---
    function switchSub(parent, name){
      ['index','search','news'].forEach(n=>{
        const btn = document.getElementById(`tab-mkt-${n}`);
        const panel = document.getElementById(`mkt-${n}`);
        const active = n===name;
        btn.setAttribute('aria-selected', active);
        panel.hidden = !active;
      });
    }
    document.getElementById('tab-mkt-index').onclick=()=>switchSub('market','index');
    document.getElementById('tab-mkt-search').onclick=()=>switchSub('market','search');
    document.getElementById('tab-mkt-news').onclick=()=>switchSub('market','news');

    // --- ê²€ìƒ‰ ë°ëª¨ ---
    document.getElementById('search').addEventListener('input', (e)=>{
      const q = e.target.value.trim();
      const list = [
        {sym:'005930', name:'ì‚¼ì„±ì „ì'},
        {sym:'000660', name:'SKí•˜ì´ë‹‰ìŠ¤'},
        {sym:'035420', name:'NAVER'},
        {sym:'005380', name:'í˜„ëŒ€ì°¨'}
      ];
      const res = list.filter(x=>x.name.includes(q) || x.sym.includes(q));
      const box = document.getElementById('searchResults');
      box.innerHTML = res.map(x=>`<div class='row'><div><strong>${x.name}</strong><div class='muted'>${x.sym}</div></div><button class='btn' onclick="selectSymbol('${x.name}','${x.sym}')">ì„ íƒ</button></div>`).join('');
    });

    window.selectSymbol = function(name, sym){
      document.getElementById('tab-trade-btn').click();
      document.getElementById('symbolTitle').textContent = `${name} (${sym})`;
      document.getElementById('symbolPrice').textContent = `í˜„ì¬ê°€ 72,300 (+1.2%)`;
      toast(`${name} ì„ íƒë¨`);
    }

    // ì•Œë¦¼ ê¶Œí•œ ë°ëª¨
    document.getElementById('notifBtn').onclick = async ()=>{
      if(!('Notification' in window)) return toast('ì•Œë¦¼ ë¯¸ì§€ì› ë¸Œë¼ìš°ì €');
      const p = await Notification.requestPermission();
      toast(p==='granted'?'ì•Œë¦¼ì´ í—ˆìš©ë˜ì—ˆì–´ìš”':'ì•Œë¦¼ì´ ê±°ë¶€ë˜ì—ˆì–´ìš”');
    }

    // íŠœí† ë¦¬ì–¼ ì•ˆë‚´
    document.getElementById('tutorialBtn').onclick = ()=>{
      toast('íŠœí† ë¦¬ì–¼: â‘ ì‹œì¥ ë³´ê¸° â‘¡ê°€ì„¤ ì„¸ìš°ê¸° â‘¢ì†ŒëŸ‰ ë§¤ìˆ˜');
    }
  </script>
</body>
</html>
